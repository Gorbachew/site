{% extends "main/maintemplate.html" %}
{% block content %}
<script type="text/javascript">
  $('#newses').toggleClass('active');
</script>

<div id="news">
  <div id="new">

    <p id="date">Опубликовано: {{ article.date|date:"d-m-Y в H:i" }} Автор: <b><a href="/{{ article.author }}/">{{ article.author }}</a>
    {% if user.id == article.author_id %}
      <a class = "text-danger" href="/news/deletenews/{{article.id}}/">Удалить пост</a>
    {% endif %}
    </b></p>
    <p id = "title">{{ article.title }}</p>
    <hr>
    <p id="post">{{ article.post|linebreaks }}</p>
    <hr>
    {% if  user.is_authenticated %}
    <h5 id = "like">Лайков: <a href="/news/addlike/{{article.id}}/"> {{ article.likes }}</a></h5>
    {% else %}
    <h5 id = "like">Лайков: {{ article.likes }}</h5>
    {% endif %}
    <h5 id="comm">Комментариев: {{article.comm}}</h5>
  </div>
  <div class="comments">
    {% for comment in comments reversed %}
    <div id="comment">
      <div class="commavatar mr-1 mt-1 float-left">

            {% for avatarcomments in avatar %}   {# Обьявление изображения из папки media/images avatar это массив image это столб базыданных#}
              {% if comment.author_id == avatarcomments.user_id %}
              <a href="/{{ user.username }}/">  <img id="commavatar" src="{{ MEDIA_URL }}{{ avatarcomments.image.url }}" /></a>
              {% endif %}
            {% endfor %}
            {% load staticfiles %}
            <a href="/{{ user.username }}/"> <img id="bandavatar" src="{% static "mypage/nophoto.png" %}" /></a>

      </div>
      <div class="content">
        <p id="id_comm" class="bg-light">Автор: <a href="/{{ comment.author }}/"><b>{{ comment.author }}</b></a> id коментария: {{ comment.id }} Дата: {{ comment.date|date:"d-m-Y в H:i" }}
          {% if  user.is_authenticated %}
          Лайков: <a href="/news/addlikecomment/{{article.id}}/{{comment.id}}"> {{ comment.likes }}</a>
          {% else %}
          Лайков: {{ comment.likes }}
          {% endif %}
          {% if user.id == comment.author_id %}
          <a  class="text-danger" href="/news/deletecomment/{{article.id}}/{{comment.id}}">Удалить комментарий</a>
          {% endif %}
        </p>
        <p class="m-1">{{ comment.text|linebreaks }}</p>
      </div>
    </div>

    {% empty %}
    <h5>Комментариев нет</h5>
    {% endfor %}
  </div>
  {% if user.is_authenticated %}
  <div id="addcomments">
    <form action="/news/addcomment/{{article.id}}/" method="post">
      {% csrf_token %}
      {% for field in form %}
        {{ field }}
        <input type="submit" class="btn btn-info" value="Добавить комментарий">
      {% endfor %}
    </form>
  </div>
  {% else %}
  <h4 class="bg-danger text-light text-center d-flex justify-content-center"> Войдите или зарегистрируйтесь, чтобы оставлять комментарии</h4>
  {% endif %}



</div>
{% endblock %}
